#import rstConsultaTradM
import trademaster_arquivo
import os
import datetime 
import time

hora = datetime.datetime.now()
hora = hora.hour
tempo_espera = 10

def main():
    print("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@@@@@@@@@@@@@@@%,,*@@@@@@@@@@@@@@@@@@@@                _                                          @@")
    print("@@@@@@@@@@@@@@@@@@@....../.,#..(@@@@@@@@@@@@@@@@               | |                                         @@")
    print("@@@@@@@@@@@@@@@@@.,@@..,&./%&/(........@@@@@@@@@               | |                                         @@")
    print("@@@@@@@@@@@@@@@@@.@,........./*.,##(.*&..@@@@@@@  / _` | / _` || | / _` || '_ \  / _` | / _` | / _ \ / __| @@")
    print("@@@@@@@@@@@@@@@@@.#...........,,.@@@@@@@@@@@@@@@ | (_| || (_| || || (_| || |) || (_| || (_| || () |\__ \   @@")
    print("@@@@@@@@@@@@@@@@@.#*,,,,/#(*.**.@@@@@@@@@@@@@@@@  \__, | \__,_||_| \__,_|| .__/  \__,_| \__, | \___/ |___/ @@")
    print("@@@@@@@@@@@@@@@@@,@*/@@@@@@@,@@&.@@@@@@@@@@@@@@@   __/ |                 | |             __/ |             @@")
    print("@@@@@@@@@@@@@@@@@..@@@(%%,......,.@@@@@@@@@@@@@@  |___/                  |_|            |___/              @@")
    print("@@@@@@@@@@@@@@@@%...@@@.*......./.%@@@@@@@@@@@@@ v 1.1                                                     @@")
    print("@@@@@@@@@@@@@@@@.,...,&,.**/.&./..@.@@@@@@@@@@@@ ========================================================= @@")
    print("@@@@@@@@@@@@@@@../,../&..%.(@@#(@@*@@.@@@@@@@@@@                                                           @@")
    print("@@@@@@@@@@@@@@..,.....@,./.@@&*./*(@@@#@@@@@@@@@                                                           @@")
    print("@@@@@@@@@@@@@#%......,*/*.#@@@@@@&*@@@,.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@@@@......./%.(*.#@@@@@@.&@@&&.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@@@......*%&%,,.,(@@@@@%@@@@&./(@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@@.,..../..@....*&@@@@@@@&@@@,,#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@....../&.*,...%@@@@@@@@@(@@(.#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@....(.(*.#%&..(@,@@@@@@@@*@@@.*.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@....**..%...,#%%@@@@@@@@@@%@@%(.(.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@.........&*..,@@@@@@@@@@@@@@/,.*.(#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@........(,.@,#(@&@@@@,@@(@@@@@#.#,%./@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@..........,.@@@@@*@@@@.@@%&@@,.&#((&..@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@....*......,.@@@&@@@@@@@%&,%(...*%@*..&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@..,,@,,..../,(#@@%@@@@@@@@@%,.&(#..%@./@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@%*.,.@@...*....@@@@@&##&&@@&,.@@,*...@.(@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@...../@.,./*.*.@@@@&..,/&(@..@@@@.#..@.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@(.*...%,..*,,,..@@@@@%&&@@@..@@@@@@(,/.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@#..*...@(.,@../.@@@@@*@%&@(.*@@@@@@@..@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@(.,*....@%..@...@//&@&#,*%*.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@....,*...*(,.@&@&../%.*%(,./@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@.....*....,@&,,%,,,../@#@(&.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@@@///%*,@@@@@@.....@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@@@@.*/,.@@@@@@,./..@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@@@@@..%.@@@@@@@..*.....&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@@@@@&..,..,/.@@@@,..,....,%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@@@@@@(..,..#...*/@@@@@@@#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("@@@@@@@@@@@@@@@@@@@.*.*.....@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
    print("\n\n")

# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

os.system("cls")
main()
print("##  1 - Inicia Monitor Limites Trade Master")  
print("## --------------------------------------------")
print("##  ")

# os.system("start C:\python\Rest_galapagos\start_rstConsultaTradM.bat tgg")

# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

while True:
    if hora == datetime.datetime.now().hour:
       os.system("cls")
       main()
       print("## 1.1 - Troca arquivos limites.xlsx")  
       print("## --------------------------------------------")
       print("##          ")
       trademaster_arquivo.startTradeMasterArq() 
       hora = datetime.datetime.now().hour + 1 
       if hora == 19:
           os.system("taskkill /f /im cmd.exe")
           os.system("taskkill /f /im python.exe")
       
    os.system("cls")
    main()
    print("##  1 - Inicia Monitor Limites Trade Master")  
    print("## --------------------------------------------")
    print("##  ")
    print(f'        Proxima atualização {hora} hora(s)')
    time.sleep(tempo_espera)
    

